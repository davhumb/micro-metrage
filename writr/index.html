<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>writr – Boîte à outils narrative</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:400,700&family=Pacifico&display=swap" rel="stylesheet">
  <style>
    body { font-family:'EB Garamond', serif; background:#e3e9f0; color:#26304c; margin:0; padding:0; display:flex; justify-content:center; }
    .tools-container { width:100%; max-width:420px; padding:2rem 1rem; }
    .site-logo { text-align:center; margin-bottom:1.5rem; }
    .site-logo img { width:64px; display:block; margin:0 auto .5rem; }
    .site-logo .logo-text { font-family:'Pacifico', cursive; color:#5a3a28; font-size:1.6rem; }
    .tool-section { position:relative; margin-bottom:2rem; padding:2rem 1.5rem; background:#fff; border:4px solid #26304c; box-shadow:inset 0 0 0 2px #26304c; }
    .tool-section .corner { position:absolute; width:24px; height:24px; }
    .corner.tl{ top:-4px; left:-4px; border-top:4px solid #26304c; border-left:4px solid #26304c; }
    .corner.tr{ top:-4px; right:-4px; border-top:4px solid #26304c; border-right:4px solid #26304c; }
    .corner.bl{ bottom:-4px; left:-4px; border-bottom:4px solid #26304c; border-left:4px solid #26304c; }
    .corner.br{ bottom:-4px; right:-4px; border-bottom:4px solid #26304c; border-right:4px solid #26304c; }
    h2 { font-size:1.25rem; color:#41516a; margin:1rem 0; text-align:center; }
    .card { background:#f5ded5; border-radius:12px; padding:1rem; min-height:4rem; font-style:italic; color:#26304c; margin-bottom:1rem; }
    button { background:#41516a; color:#fff; border:none; padding:.75rem 1.5rem; border-radius:12px; font-size:1rem; cursor:pointer; transition:background .2s; display:block; width:100%; max-width:200px; margin:.5rem auto 0 auto; }
    button:active { background:#26304c; }
    .buttons { display:flex; gap:1rem; justify-content:center; flex-wrap:wrap; margin-bottom:1rem; }
    @media (max-width:480px){ .buttons { flex-direction:column; } }
  </style>
</head>
<body>
  <div class="tools-container">

    <div class="site-logo">
      <img src="logo-writr.png" alt="Logo writr">
      <div class="logo-text">writr</div>
    </div>

    <!-- Générateur d'idées narratives (INCHANGÉ) -->
    <section class="tool-section" id="bloc-idees">
      <span class="corner tl"></span><span class="corner tr"></span><span class="corner bl"></span><span class="corner br"></span>
      <h2>Générateur d’idées narratives</h2>
      <div class="card" id="idea">Chargement…</div>
      <div class="buttons">
        <button id="generate-idea-btn">Nouvelle idée</button>
        <button id="generate-etsi-btn">Et si…</button>
      </div>
    </section>

    <!-- Générateur de noms -->
    <section class="tool-section">
      <span class="corner tl"></span><span class="corner tr"></span><span class="corner bl"></span><span class="corner br"></span>
      <h2>Générateur de noms de personnages</h2>
      <div class="filters">
        <div><label for="genre">Sexe</label>
          <select id="genre">
            <option value="masculin">Masculin</option>
            <option value="féminin">Féminin</option>
          </select>
        </div>
        <div><label for="style">Style</label>
          <select id="style">
            <option value="fr">Français</option>
            <option value="en">Anglo-saxon</option>
            <option value="insolite">Insolite</option>
          </select>
        </div>
      </div>
      <button id="generate-name-btn" disabled>Chargement…</button>
      <div class="card" id="name">Chargement…</div>
    </section>
  </div>

  <script>
    // ===============================
    // Générateur d’idées narratives (inchangé)
    // ===============================
    const base = [ /* ... tes consignes de base ... */ ];
    const etSi = [
      "votre héros se mettait à saigner du nez", "le ciel devenait soudain vert", "les animaux parlaient", "un inconnu lisait vos pensées",
      "le temps s’arrêtait une seconde", "une porte apparaissait au plafond", "un écho révélait un secret", "la gravité s’inversait",
      "les ombres bougeaient seules", "le sol se fissurait doucement", "un parfum inconnu envahissait la pièce", "les objets évoquaient un souvenir",
      "le narrateur changeait de voix", "un souvenir d’enfance ressurgissait", "les murs devenaient translucides", "un chant lointain guidait le personnage",
      "la couleur de tout changeait", "les mots sur le papier disparaissaient", "un rire résonnait sans source", "le reflet ne vous ressemblait pas",
      "un oiseau entrait dans la pièce fermée", "un miroir montrait l’avenir", "une lettre disparaissait", "un détail se répétait bizarrement",
      "un bruit sourd venait du sol", "les pas sonnaient à l’intérieur du corps", "un objet prenait vie", "votre mémoire s’effaçait",
      "un personnage secondaire devenait narrateur", "les murs avaient des cicatrices"
    ];
    let pool = base.map(c => ({categorie:c.categorie, abstraction:c.abstraction, consigne:c.consigne}))
                  .concat(etSi.map(t => ({categorie:"Et si…", abstraction:"idée", consigne:`Et si ${t} ?`})));
    while(pool.length < 250){
      pool = pool.concat(pool.slice(0, Math.min(pool.length, 250 - pool.length)));
    }
    pool = pool.sort(() => Math.random() - 0.5).slice(0,250);

    document.getElementById('generate-idea-btn').addEventListener('click', ()=> {
      const c = pool[Math.floor(Math.random()*pool.length)];
      document.getElementById('idea').innerHTML = `<strong>${c.categorie}</strong> (${c.abstraction})<br>${c.consigne}`;
    });
    document.getElementById('generate-etsi-btn').addEventListener('click', ()=> {
      const text = etSi[Math.floor(Math.random()*etSi.length)];
      document.getElementById('idea').innerHTML = `<strong>Et si…</strong> (idée)<br>Et si ${text} ?`;
    });
    window.addEventListener('DOMContentLoaded', ()=>document.getElementById('generate-idea-btn').click());

    // ===============================
    // Générateur de noms avec noms.json
    // ===============================
    let nomsDB = null;
    const nameBtn = document.getElementById('generate-name-btn');
    const nameDiv = document.getElementById('name');
    nameBtn.disabled = true;
    nameBtn.innerText = "Chargement…";
    nameDiv.innerText = "Chargement…";

    fetch('data/noms.json')
      .then(r => r.json())
      .then(data => {
        nomsDB = data;
        nameBtn.disabled = false;
        nameBtn.innerText = "Générer un nom";
        nameDiv.innerText = "Clique sur le bouton pour générer un nom.";
      });

    nameBtn.addEventListener('click', () => {
      if(!nomsDB) return;
      const genre = document.getElementById('genre').value;
      const style = document.getElementById('style').value;
      // Récupérer listes selon le format du JSON (adapté à ton format)
      const prenoms = nomsDB.prenoms?.[style]?.[genre] || [];
      const noms    = nomsDB.noms?.[style] || [];
      // Tirage aléatoire
      const prenom = prenoms.length ? prenoms[Math.floor(Math.random()*prenoms.length)] : "(prénom)";
      const nom = noms.length ? noms[Math.floor(Math.random()*noms.length)] : "(nom)";
      nameDiv.innerHTML = `<strong>${prenom} ${nom}</strong>`;
    });
  </script>
</body>
</html>
